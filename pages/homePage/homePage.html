<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Note App :)</title>
  </head>
  <body>
    <h2 id="email">Hi World</h2>
    <button id="btn">hi</button>
  </body>

  <script>
    let token = document.cookie || "";
    function parseJwt(token) {
      let base64Url = token.split(".")[1];
      console.log(base64Url);
      let base64 = base64Url.replace(/-/g, "+").replace(/_/g, "/");
      let jsonPayload = decodeURIComponent(
        window
          .atob(base64)
          .split("")
          .map(function (c) {
            return "%" + ("00" + c.charCodeAt(0).toString(16)).slice(-2);
          })
          .join("")
      );

      return JSON.parse(jsonPayload);
    }

    async function verifyUser() {
      let payload = parseJwt(token);
      let userEmail = payload.user.email;
      console.log(typeof userEmail);
      const URL = "http://127.0.0.1:8080/verifyApi";
      let userMail = {
        email: userEmail,
      };
      const response = await fetch(URL, {
        method: "POST",
        body: JSON.stringify(userMail),
      });
      const data = await response.text();
      console.log(data);
    }
    document.getElementById("btn").addEventListener("click", () => {
      verifyUser();
    });
    // window.addEventListener("DOMContentLoaded", () => {
    // });
  </script>
</html>
